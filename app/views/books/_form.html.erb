<%= form_with(model: book) do |form| %>
<% if book.errors.any? %>
<div style="color: red">
    <h2><%= pluralize(book.errors.count, "error") %> prohibited this book from being saved:</h2>
    <ul>
        <% book.errors.each do |error| %>
        <li><%= error.full_message %></li>
        <% end %>
    </ul>
</div>
<% end %>

<div>
    <%= form.label :title, "Título", style: "display: block" %>
    <%= form.text_field :title, class: "form-control" %>
</div>

<div>
    <%= form.label :publisher, "Editora", style: "display: block" %>
    <%= form.text_field :publisher, class: "form-control" %>
</div>

<div>
    <%= form.label :year_published, "Ano de Publicaçao", style: "display: block" %>
    <%= form.number_field :year_published, class: "form-control" %>
</div>

<div>
    <%= form.label :shelf, "Prateleira", style: "display: block" %>
    <%= form.text_field :shelf, class: "form-control" %>
</div>

<div>
    <%= form.label :quanty, "Quantidade de Exemplares:", style: "display: block" %>
    <%= form.number_field :quanty, class: "form-control" %>
</div>

<div id="genres-fields">

    <%= form.label :genre_ids, "Gêneros" %><br>
    <%= form.collection_check_boxes(:genre_ids, Genre.all, :id, :name) %>
</div>

<div>
    <label>Autores</label>
    <div id="authors-container">
      <div class="author-select">
        <%= form.collection_select :author_ids, Author.all, :id, :name, {}, { class: "form-control author-dropdown" } %>
      </div>
    </div>
    <button type="button" id="add-author" class="btn btn-secondary">Adicionar Autor</button>
</div>

<div>
    <%= form.submit class: "btn btn-primary" %>
</div>
<% end %>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    document.getElementById("add-author").addEventListener("click", function() {
      let container = document.getElementById("authors-container");
      let newDropdown = document.querySelector(".author-select").cloneNode(true);
      container.appendChild(newDropdown);
    });
  });
</script>