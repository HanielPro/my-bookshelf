<%= form_with(model: book) do |form| %>
<% if book.errors.any? %>
<div style="color: red">
    <h2><%= pluralize(book.errors.count, "error") %> impediram o salvamento deste livro:</h2>
    <ul>
        <% book.errors.each do |error| %>
        <li><%= error.full_message %></li>
        <% end %>
    </ul>
</div>
<% end %>

<div>
    <%= form.label :Título, style: "display: block" %>
    <%= form.text_field :title %>
</div>

<div>
    <%= form.label :Editora, style: "display: block" %>
    <%= form.text_field :publisher %>
</div>

<div>
    <%= form.label :Ano_de_publicação, style: "display: block" %>
    <%= form.number_field :year_published %>
</div>

<div>
    <%= form.label :Número_da_plateleira, style: "display: block" %>
    <%= form.text_field :shelf %>
</div>

<div>
    <%= form.label :Quantidade, style: "display: block" %>
    <%= form.number_field :quanty %>
</div>

<div id="genres-fields">

    <%= form.label :genre_ids, "Gêneros" %><br>
    <%= form.collection_check_boxes(:genre_ids, Genre.all, :id, :name) %>
</div>

<div>
  
    <label>Autores</label>
    <div id="authors-container">
      <div class="author-select">
        <%= form.collection_select :author_ids, Author.all, :id, :name, {}, { class: "form-control author-dropdown" } %>
      </div>
    </div>
    <button type="button" id="add-author" class="btn btn-secondary">Adicionar Autor</button>
</div>

<div>
    <%= form.submit "Salvar Livro"%>
</div>
<% end %>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    document.getElementById("add-author").addEventListener("click", function() {
      let container = document.getElementById("authors-container");
      let newDropdown = document.querySelector(".author-select").cloneNode(true);
      container.appendChild(newDropdown);
    });
  });
</script>